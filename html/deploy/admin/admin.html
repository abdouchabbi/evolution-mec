<!DOCTYPE html>
<html lang="it" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pannello Amministratore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100">

    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-75 z-[100] flex flex-col items-center justify-center">
        <div class="loader"></div>
        <p class="text-white text-lg mt-4">Caricamento del sistema...</p>
    </div>

    <div id="main-app-view" class="flex h-screen bg-gray-100 hidden">
        <aside class="w-64 bg-gray-800 text-white flex-col no-print hidden md:flex">
            <div class="h-20 flex items-center justify-center text-2xl font-bold border-b border-gray-700">
                Pannello
            </div>
            <nav class="flex-1 px-2 py-4 space-y-2">
                <a href="#dashboard" class="sidebar-link active flex items-center px-4 py-2 rounded-md" data-section="dashboard-section">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
                    </svg>
                    <span>Dashboard</span>
                </a>
                <a href="#employees" class="sidebar-link flex items-center px-4 py-2 rounded-md" data-section="employees-section">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <span>Dipendenti</span>
                </a>
                <a href="#clients" class="sidebar-link flex items-center px-4 py-2 rounded-md" data-section="clients-section">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    <span>Clienti e Progetti</span>
                </a>
                <a href="#reports" class="sidebar-link flex items-center px-4 py-2 rounded-md" data-section="reports-section">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <span>Report</span>
                </a>
                <a href="#users" class="sidebar-link flex items-center px-4 py-2 rounded-md" data-section="users-section">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span>Gestione Utenti</span>
                </a>
                 <a href="#settings" class="sidebar-link flex items-center px-4 py-2 rounded-md" data-section="settings-section">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995a6.473 6.473 0 0 1 0 1.248c0 .382.146.755.438.995l1.003.827c.424.35.534.954.26 1.431l-1.296 2.247a1.125 1.125 0 0 1-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 0 1-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.437-.995a6.473 6.473 0 0 1 0-1.248c0-.382-.146-.755-.438-.995l-1.004-.827a1.125 1.125 0 0 1-.26-1.431l1.296-2.247a1.125 1.125 0 0 1 1.37-.49l1.217.456c.355.133.75.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span>Impostazioni</span>
                </a>
            </nav>
            <div class="mt-auto p-4 border-t border-gray-700">
                 <button id="logout-btn" class="w-full flex items-center justify-center px-4 py-2 rounded-md bg-red-600 hover:bg-red-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <main class="flex-1 p-6 overflow-auto">
            
            <div class="flex justify-between items-center mb-6">
                <h1 id="main-header-title" class="text-3xl font-bold text-gray-800">Dashboard Principale</h1>
                <div class="relative">
                    <button id="notification-bell-btn" class="relative text-gray-600 hover:text-gray-800 focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                        </svg>
                        <span id="notification-badge" class="absolute -top-1 -right-1 h-4 w-4 rounded-full bg-red-600 text-white text-xs flex items-center justify-center hidden">0</span>
                    </button>
                    <div id="notification-panel" class="notification-panel absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl overflow-hidden z-20 hidden">
                        <div class="py-2 px-4 text-sm font-semibold border-b">Notifiche</div>
                        <ul id="notification-list" class="divide-y max-h-96 overflow-y-auto">
                           <li class="p-4 text-center text-gray-500">Nessuna notifica.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <section id="dashboard-section">
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-center">
                        <div class="bg-blue-100 p-4 rounded-full mr-4">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-gray-500 text-lg font-bold">Dipendenti</h3>
                            <p id="total-employees" class="text-4xl font-bold">0</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-center">
                        <div class="bg-green-100 p-4 rounded-full mr-4">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-gray-500 text-lg font-bold">Clienti</h3>
                            <p id="total-clients" class="text-4xl font-bold">0</p>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md flex items-center">
                         <div class="bg-yellow-100 p-4 rounded-full mr-4">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                         </div>
                        <div>
                            <h3 class="text-gray-500 text-lg font-bold">Progetti</h3>
                            <p id="total-projects" class="text-4xl font-bold">0</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex items-center">
                        <div class="bg-purple-100 p-4 rounded-full mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                       <div>
                           <h3 class="text-gray-500 text-lg font-bold">Ore del Mese</h3>
                           <p id="total-hours-month" class="text-4xl font-bold">0</p>
                       </div>
                   </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                    <div class="lg:col-span-3 bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Ore per Dipendente (Mese Corrente)</h2>
                        <div class="h-80">
                            <canvas id="employees-chart"></canvas>
                        </div>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Ore per Progetto (Mese Corrente)</h2>
                        <div class="h-80">
                            <canvas id="projects-chart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="mt-6 bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-xl font-bold mb-4">Attività Recenti</h2>
                    <ul id="recent-activity-list" class="space-y-3">
                    </ul>
                </div>
            </section>
            
            <section id="employees-section" class="hidden">
                 <div class="bg-white p-6 rounded-lg shadow-md">
                     <div class="flex items-center mb-4">
                         <input type="text" id="new-employee-name" placeholder="Aggiungi nuovo dipendente..." class="flex-grow p-2 border border-gray-300 rounded-md">
                         <button id="add-employee-btn" class="bg-blue-600 text-white px-6 py-2 rounded-md ml-4 hover:bg-blue-700">Aggiungi</button>
                     </div>
                     <div class="overflow-auto max-h-[60vh]">
                         <table class="w-full text-sm text-left border-collapse border border-slate-400">
                             <thead class="bg-gray-100 sticky top-0">
                                 <tr>
                                     <th class="p-3 border border-slate-300">Nome Dipendente</th>
                                     <th class="p-3 text-center border border-slate-300">Stato Impronta</th>
                                     <th class="p-3 text-center border border-slate-300">Azioni</th>
                                 </tr>
                             </thead>
                             <tbody id="employees-table-body"></tbody>
                         </table>
                     </div>
                 </div>
            </section>
            
            <section id="clients-section" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Clienti</h2>
                         <div class="space-y-4 mb-4">
                            <input type="text" id="client-name-input" placeholder="Nome nuovo cliente" class="w-full p-2 border rounded-md">
                            <input type="email" id="client-email-input" placeholder="Email" class="w-full p-2 border rounded-md">
                        </div>
                        <button id="add-client-btn" class="w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700">Aggiungi Cliente</button>
                        <hr class="my-6">
                        <div id="clients-table-container" class="max-h-64 overflow-auto">
                            <table class="w-full text-sm text-left border-collapse border border-slate-400">
                                <thead class="bg-gray-100 sticky top-0"><tr><th class="p-2 border border-slate-300">Nome Cliente</th><th class="p-2 border border-slate-300">Email</th><th class="p-2 border border-slate-300">Azione</th></tr></thead>
                                <tbody id="clients-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Progetti</h2>
                        <div class="space-y-4 mb-4">
                            <input type="text" id="project-name-input" placeholder="Nome nuovo progetto" class="w-full p-2 border rounded-md">
                            <select id="project-client-select" class="w-full p-2 border rounded-md"><option value="">-- Seleziona Cliente --</option></select>
                            <input type="number" id="project-rate-input" placeholder="Tariffa Oraria" class="w-full p-2 border rounded-md">
                        </div>
                        <button id="add-project-btn" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Aggiungi Progetto</button>
                        <hr class="my-6">
                        <div id="projects-table-container" class="max-h-64 overflow-auto">
                            <table class="w-full text-sm text-left border-collapse border border-slate-400">
                                <thead class="bg-gray-100 sticky top-0"><tr><th class="p-2 border border-slate-300">Nome Progetto</th><th class="p-2 border border-slate-300">Cliente</th><th class="p-2 border border-slate-300">Azione</th></tr></thead>
                                <tbody id="projects-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="reports-section" class="hidden">
                 <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 items-end no-print">
                        <div>
                            <label for="report-employee-select" class="block text-sm font-medium">Seleziona Dipendente:</label>
                            <select id="report-employee-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md"></select>
                        </div>
                        <div>
                            <label for="report-month-select" class="block text-sm font-medium">Seleziona Mese:</label>
                            <select id="report-month-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md"></select>
                        </div>
                        <div>
                            <label for="report-year-select" class="block text-sm font-medium">Seleziona Anno:</label>
                            <select id="report-year-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md"></select>
                        </div>
                        <div class="flex gap-2">
                            <button id="generate-report-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg w-full">Genera Report</button>
                        </div>
                    </div>
                    <div id="report-actions" class="mt-4 flex gap-2 no-print hidden">
                        <button id="print-report-btn" class="bg-gray-600 text-white px-4 py-2 rounded-lg">Stampa</button>
                        <button id="export-png-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg">Esporta PNG</button>
                        <button id="export-pdf-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg">Esporta PDF</button>
                    </div>
                    <div id="report-output" class="mt-4">
                         <p class="text-center text-gray-500 py-8">Seleziona un dipendente e un mese per generare il report.</p>
                    </div>
                 </div>
            </section>

            <section id="users-section" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Aggiungi Nuovo Admin</h2>
                        <form id="add-user-form" class="space-y-4">
                            <div>
                                <label for="new-user-name" class="block text-sm font-medium">Nome</label>
                                <input type="text" id="new-user-name" required class="w-full p-2 mt-1 border rounded-md">
                            </div>
                            <div>
                                <label for="new-user-email" class="block text-sm font-medium">Email</label>
                                <input type="email" id="new-user-email" required class="w-full p-2 mt-1 border rounded-md">
                            </div>
                            <div>
                                <label for="new-user-password" class="block text-sm font-medium">Password</label>
                                <input type="password" id="new-user-password" required class="w-full p-2 mt-1 border rounded-md">
                            </div>
                            <button type="submit" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Aggiungi Utente</button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-bold mb-4">Cambia la mia Password</h2>
                        <form id="change-password-form" class="space-y-4">
                            <div>
                                <label for="update-password" class="block text-sm font-medium">Nuova Password</label>
                                <input type="password" id="update-password" required class="w-full p-2 mt-1 border rounded-md">
                            </div>
                             <div>
                                <label for="confirm-password" class="block text-sm font-medium">Conferma Password</label>
                                <input type="password" id="confirm-password" required class="w-full p-2 mt-1 border rounded-md">
                            </div>
                            <button type="submit" class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">Aggiorna Password</button>
                        </form>
                    </div>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                     <h2 class="text-xl font-bold mb-4">Lista Amministratori</h2>
                     <div class="overflow-auto max-h-[40vh]">
                         <table class="w-full text-sm text-left border-collapse border border-slate-400">
                             <thead class="bg-gray-100 sticky top-0"><tr><th class="p-3 border border-slate-300">Nome</th><th class="p-3 border border-slate-300">Email</th><th class="p-3 text-center border border-slate-300">Azione</th></tr></thead>
                             <tbody id="users-table-body"></tbody>
                         </table>
                     </div>
                 </div>
            </section>
            
            <section id="settings-section" class="hidden">
                 <div class="bg-white p-6 rounded-lg shadow-md">
                     <h2 class="text-xl font-bold mb-4">Dati Aziendali</h2>
                     <div class="mb-6">
                         <label for="company-name-input" class="block text-sm font-medium text-gray-700">Nome Azienda</label>
                         <input type="text" id="company-name-input" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="Es. Evolution Mec Srls">
                     </div>

                     <h3 class="text-xl font-bold mb-4">Logo Aziendale</h3>
                     <p class="text-gray-600 mb-4">Carica il logo della tua azienda. Verrà visualizzato nei report.</p>
                     <p class="text-xs text-gray-500 mb-4">Dimensioni consigliate: 200x80px per la migliore qualità.</p>
                     <div class="flex items-center gap-4">
                         <input type="file" id="logo-upload-input" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" accept="image/*">
                     </div>
                     <div class="mt-4">
                         <h3 class="font-bold mb-2">Anteprima:</h3>
                         <div class="w-48 h-24 border rounded-md flex items-center justify-center bg-gray-50">
                             <img id="logo-preview" src="" alt="Anteprima Logo" class="max-w-full max-h-full">
                         </div>
                     </div>
                     <div class="mt-6 flex gap-4">
                         <button id="save-settings-btn" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700">Salva Impostazioni</button>
                         <button id="remove-logo-btn" class="bg-red-600 text-white px-6 py-2 rounded-md hover:bg-red-700">Rimuovi Logo</button>
                     </div>
                 </div>

                <!-- Modifica: Sezione per il QR Code con più opzioni -->
                <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                    <h2 class="text-xl font-bold mb-4">Configurazione Kiosk ID</h2>
                    <p class="text-gray-600 mb-4">
                        Qui puoi impostare un ID personalizzato per il tuo Kiosk. Questo ID verrà usato per generare il QR code.
                    </p>
                    <div class="flex items-end gap-4">
                        <div class="flex-grow">
                            <label for="kiosk-id-input" class="block text-sm font-medium text-gray-700">Kiosk ID Personalizzato</label>
                            <input type="text" id="kiosk-id-input" class="mt-1 block w-full p-2 border border-gray-300 rounded-md">
                        </div>
                        <button id="save-kiosk-id-btn" class="bg-indigo-600 text-white px-6 py-2 rounded-md hover:bg-indigo-700 whitespace-nowrap">
                            Salva e Genera QR
                        </button>
                    </div>
                    <div class="mt-6 text-center">
                        <div id="kiosk-qrcode-container" class="inline-block p-4 bg-white border rounded-md shadow-inner min-h-[150px] min-w-[150px] flex items-center justify-center text-gray-400">
                           Il QR Code apparirà qui...
                        </div>
                        <div class="mt-4">
                             <button id="download-qr-btn" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 hidden">
                                Scarica PNG
                            </button>
                        </div>
                    </div>
                </div>


                <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                    <h2 class="text-xl font-bold mb-4">Gestione Festività</h2>
                    <div class="flex items-end gap-4 mb-6 pb-4 border-b">
                        <div class="flex-grow">
                            <label for="holiday-name-input" class="block text-sm font-medium text-gray-700">Nome Festività:</label>
                            <input type="text" id="holiday-name-input" class="w-full p-2 border rounded-md mt-1">
                        </div>
                        <div class="flex-grow">
                            <label for="holiday-date-input" class="block text-sm font-medium text-gray-700">Data:</label>
                            <input type="date" id="holiday-date-input" class="w-full p-2 border rounded-md mt-1">
                        </div>
                        <button id="add-holiday-btn" class="bg-blue-600 text-white px-6 py-2 rounded-lg">Aggiungi</button>
                    </div>
                    <div class="overflow-auto max-h-[40vh]">
                        <table class="w-full text-sm border-collapse border border-slate-400">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-2 text-left border border-slate-300">Nome</th>
                                    <th class="p-2 text-left border border-slate-300">Data</th>
                                    <th class="p-2 text-center border border-slate-300">Azione</th>
                                </tr>
                            </thead>
                            <tbody id="holidays-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                    <h2 class="text-xl font-bold mb-4">Gestione Permessi e Ferie</h2>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end mb-6 pb-4 border-b">
                        <div>
                            <label for="leave-employee-select" class="block text-sm font-medium text-gray-700">Dipendente:</label>
                            <select id="leave-employee-select" class="w-full p-2 border rounded-md mt-1"></select>
                        </div>
                        <div>
                            <label for="leave-type-input" class="block text-sm font-medium text-gray-700">Tipo (es. Ferie, Permesso):</label>
                            <input type="text" id="leave-type-input" class="w-full p-2 border rounded-md mt-1">
                        </div>
                        <div>
                            <label for="leave-start-date-input" class="block text-sm font-medium text-gray-700">Data Inizio:</label>
                            <input type="date" id="leave-start-date-input" class="w-full p-2 border rounded-md mt-1">
                        </div>
                        <div>
                            <label for="leave-end-date-input" class="block text-sm font-medium text-gray-700">Data Fine:</label>
                            <input type="date" id="leave-end-date-input" class="w-full p-2 border rounded-md mt-1">
                        </div>
                    </div>
                    <button id="add-leave-btn" class="bg-green-600 text-white px-6 py-2 rounded-lg">Aggiungi Permesso/Ferie</button>
                    <div class="overflow-auto max-h-[40vh] mt-6">
                        <table class="w-full text-sm border-collapse border border-slate-400">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-2 text-left border border-slate-300">Dipendente</th>
                                    <th class="p-2 text-left border border-slate-300">Tipo</th>
                                    <th class="p-2 text-left border border-slate-300">Inizio</th>
                                    <th class="p-2 text-left border border-slate-300">Fine</th>
                                    <th class="p-2 text-center border border-slate-300">Azione</th>
                                </tr>
                            </thead>
                            <tbody id="leave-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modals -->
    <div id="alert-modal" class="modal fixed inset-0 bg-gray-800 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div id="alert-modal-content" class="modal-content bg-white p-6 sm:p-8 rounded-lg shadow-xl w-full max-w-md transform scale-95 opacity-0"></div>
    </div>

    <div id="face-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-sm p-6 text-center">
            <h3 id="face-modal-title" class="text-lg font-bold mb-4"></h3>
            <div class="bg-gray-200 w-full aspect-square rounded-md mb-4">
                <video id="video" width="300" height="300" autoplay muted playsinline></video>
            </div>
            <p id="status-message" class="mb-4 h-6">Punta il viso verso la fotocamera...</p>
            <div class="flex gap-4">
                <button id="cancel-face-btn" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition">Annulla</button>
                <button id="action-face-btn" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition disabled:bg-gray-400" disabled>Registra</button>
            </div>
        </div>
    </div>

    <div id="pin-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-sm p-6 text-center">
            <h3 id="pin-modal-title" class="text-lg font-bold mb-4">Imposta Codice PIN</h3>
            <p id="pin-employee-name" class="mb-4 text-gray-600"></p>
            <input type="password" id="pin-input" maxlength="4" class="w-full text-center text-2xl p-2 border rounded-md tracking-[1em]" placeholder="----">
            <div class="flex gap-4 mt-4">
                <button id="cancel-pin-btn" class="w-full bg-gray-500 text-white py-2 rounded-lg">Annulla</button>
                <button id="save-pin-btn" class="w-full bg-indigo-600 text-white py-2 rounded-lg">Salva</button>
            </div>
        </div>
    </div>

    <div id="edit-user-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-md p-6">
            <h3 id="edit-user-title" class="text-lg font-bold mb-4">Modifica Dati Utente</h3>
            <form id="edit-user-form" class="space-y-4">
                <input type="hidden" id="edit-user-id">
                <div>
                    <label for="edit-user-name" class="block text-sm font-medium">Nome</label>
                    <input type="text" id="edit-user-name" required class="w-full p-2 mt-1 border rounded-md">
                </div>
                <div>
                    <label for="edit-user-email" class="block text-sm font-medium">Email</label>
                    <input type="email" id="edit-user-email" required class="w-full p-2 mt-1 border rounded-md" disabled>
                </div>
                <div>
                    <label for="edit-user-password" class="block text-sm font-medium">Nuova Password (opzionale)</label>
                    <input type="password" id="edit-user-password" class="w-full p-2 mt-1 border rounded-md" placeholder="Lascia vuoto per non modificare">
                </div>
                 <div class="flex justify-end gap-4 pt-4 border-t">
                    <button type="button" id="cancel-edit-user-btn" class="bg-gray-500 text-white px-4 py-2 rounded-lg">Annulla</button>
                    <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded-lg">Salva Modifiche</button>
                </div>
            </form>
        </div>
    </div>

    <div id="edit-day-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-[60] p-4">
        <div class="modal-content bg-white rounded-lg shadow-xl w-full max-w-2xl p-6">
            <h3 id="edit-day-modal-title" class="text-xl font-bold mb-4">Modifica Orari del Giorno</h3>
            <div id="edit-entries-container" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2">
            </div>
            <div class="flex justify-between items-center mt-6 pt-4 border-t">
                <button id="add-entry-row-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm">Aggiungi riga</button>
                <div>
                    <button id="cancel-edit-day-btn" class="bg-gray-500 text-white px-6 py-2 rounded-lg mr-2">Annulla</button>
                    <button id="save-day-edits-btn" class="bg-indigo-600 text-white px-6 py-2 rounded-lg">Salva Modifiche</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js" defer></script>
</body>
</html>

